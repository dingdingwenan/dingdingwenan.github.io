<!doctype html>
<html lang="zh-cmn-Hans">
<!--[if lt IE 7 ]>
<html class="ie6" lang="zh-cmn-Hans"><![endif]-->
<!--[if IE 7 ]>
<html class="ie7" lang="zh-cmn-Hans"><![endif]-->
<!--[if IE 8 ]>
<html class="ie8" lang="zh-cmn-Hans"><![endif]-->
<!--[if IE 9 ]>
<html class="ie9" lang="zh-cmn-Hans"><![endif]-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=2.0,maximum-scale=1,user-scalable=no">
    <title>花大姐</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        body {
            max-width: 640px;
            margin: auto;

        }

        canvas {
            background: #ccc;

        }
    </style>
</head>
<body>
<canvas id="canvas"></canvas>
</body>
<script src="../c.js"></script>
<script src="../g.js"></script>
<script>
    window.onload = function () {
        /* 自定义变量区 */
        /* 自定义函数区 */
        /* 游戏框架注入 */

        var select=null;
        var cha_x=0;
        var cha_y=0;

        G.config({
            loadingRes: [
                {name: "bug", src: "../huadajie/img/bug.png", loaded: false},
            ],
            //debug:false,
            loadingResFn: function (loadedCount, allCount) {
            },
            loadingResEnd: function () {
                var bug = {
                    x: 10,
                    y: 10,
                    w: 30,
                    h: 30,
                    img: G.res.bug
                }
                G.spirits.push(bug);
                var bug = {
                    x: 160,
                    y: 160,
                    w: G.res.bug.width,
                    h: G.res.bug.height,
                    img: G.res.bug
                }
                G.spirits.push(bug);
                var bug = {
                    x: 200,
                    y: 300,
                    w: 50,
                    h: 50,
                    img: G.res.bug
                }
                G.spirits.push(bug);
                var bug = {
                    x: 100,
                    y: 300,
                    w: 80,
                    h: 80,
                    img: G.res.bug
                }
                G.spirits.push(bug);
                G.start();
            },
            loopingBefpre: function () {
            },
            playerLooping: function (player) {

            },
            loopingSpirit: function (spirit, index) {
                c.drawImage(spirit.img, spirit.x, spirit.y, spirit.w, spirit.h);
            },
            loopingAfter: function () {
            },
            touchFn:{
                start:function(x,y){
                    G.out(x);
                    G.out("start")
                    G.out(y);
                    select=null;
                    for(i=0;i< G.spirits.length;i++){
                        var spirit= G.spirits[i];
                        if(spirit.x<x && spirit.x+spirit.w>x && spirit.y<y && spirit.y+spirit.h>y){
                            G.out("in :"+ i);
                            select=spirit;
                            cha_x=x-select.x;
                            cha_y=y-select.y;
                        }
                    }
                },
                move:function(x,y){
                    G.out(x);
                    G.out("move")
                    G.out(y);
                    if(select!=null){
                        select.x=x-cha_x;
                        select.y=y-cha_y;
                    }
                },
                end:function(x,y){
                    G.out(x);
                    G.out("end")
                    G.out(y);
                }
            }
        });
        /* 初始化游戏 */
        G.init();
    }
</script>
</html>